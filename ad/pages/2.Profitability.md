# Profitability Deep-Dive

## Customer Profitability Distribution

```sql top_customers
SELECT * FROM customer_profitability
ORDER BY profit DESC
LIMIT 10
```

```sql bottom_customers
SELECT * FROM customer_profitability
ORDER BY profit ASC
LIMIT 10
```


## Leaders: 
These customers represent your best relationships - high profit, strong margins. Priority should be retention, expansion, and using them as templates for ideal customer profiles when prospecting. 
<DataTable data={top_customers}>
    <Column id=Customer_Name title="Customer"/>
    <Column id=Customer_Type title="Type"/>
    <Column id=profit title="Profit" fmt='$#,##0' contentType=colorscale scaleColor=green/>
    <Column id=margin_pct title="Margin %" fmt='#0.0"%"'/>
    <Column id=revenue title="Revenue" fmt='$#,##0'/>
</DataTable>

## Laggards:
Bottom customers should be reviewed for pricing corrections, service scope reduction, or exit strategies. Taking a phased approach starting with small impact accounts could impact bottom line.
<DataTable data={bottom_customers}>
    <Column id=Customer_Name title="Customer"/>
    <Column id=Customer_Type title="Type"/>
    <Column id=profit title="Profit" fmt='$#,##0' contentType=colorscale scaleColor=red/>
    <Column id=margin_pct title="Margin %" fmt='#0.0"%"'/>
    <Column id=revenue title="Revenue" fmt='$#,##0'/>
</DataTable>



```sql unprofitable_total
SELECT 
    COUNT(*) as unprofitable_count,
    SUM(profit) as total_loss,
    SUM(revenue) as revenue_at_risk
FROM customer_profitability
WHERE profit < 0
```

##
<Alert status="warning">

**Recommendation**: 

Implement immediate pricing reviews for negative-margin customers. Even converting half of these losses to breakeven would materially improve profitability without sacrificing growth. 

</Alert>

# Customer Concentration

```sql concentration
SELECT * FROM customer_concentration
ORDER BY pct_of_total_profit DESC
```

<DataTable data={concentration}>
    <Column id=customer_segment title="Segment"/>
    <Column id=customer_count title="Customers" fmt='#,##0'/>
    <Column id=total_profit title="Total Profit" fmt='$#,##0'/>
    <Column id=pct_of_total_profit title="% of Profit" fmt='#0.0"%"' contentType=colorscale scaleColor=green/>
</DataTable>

<Alert status="warning">

**Recommendation**: 
Focus on building the middle and emerging tier from the bottom 50% of accounts to grow them into anchor accounts slowly over time.
Look for new demand amongst products with a stock surplus or favorable margin and offer customers incentives to grow their footprint.
Continue to service Gleason, Hahn, and Reichert at full-service, but also look to consolidate cost of servicing to a smaller, specailized team and distribute proactive efforts towards the bottom 50% of the pack.
Target Accounts for Growth: Smitham, Schroeder and Parker (High Margin), Bins and Sons (High Margin, potential to convert into premier)

</Alert>


# Multi-Facility Customer Analysis
```sql multi_facility
SELECT * FROM multi_facility_customers
ORDER BY total_profit ASC
LIMIT 15
```

Customers served across multiple facilities are strategic national accounts or have purchasing patterns that exacerbate our operational inefficiencies for storing inventory. Low profitability here suggests coordination issues, duplicate costs, or pricing that doesn't account for complexity 

<DataTable data={multi_facility}>
    <Column id=Customer_Name title="Customer"/>
    <Column id=Customer_Type title="Type"/>
    <Column id=facility_count title="Facilities" fmt='#,##0'/>
    <Column id=facilities title="Facility List"/>
    <Column id=total_profit title="Profit" fmt='$#,##0' contentType=colorscale scaleColor=red/>
    <Column id=margin_pct title="Margin %" fmt='#0.0"%"'/>
    <Column id=total_revenue title="Revenue" fmt='$#,##0'/>
</DataTable>

```sql multi_facility_summary
SELECT 
    AVG(margin_pct) as avg_margin_multi,
    COUNT(*) as multi_facility_customers
FROM multi_facility_customers
```
```sql single_facility_avg
SELECT 
    AVG(margin_pct) as avg_margin_single
FROM customer_profitability
WHERE facilities_served = 1
```

### Key Finding: 
Multi-facility customers average <Value data={multi_facility_summary} column=avg_margin_multi fmt='#0.1"%"'/> margin versus <Value data={single_facility_avg} column=avg_margin_single fmt='#0.1"%"'/> for single-facility customers. 

<Alert status="warning">

**Recommendation:**

Since multi-facility margins are lower, investigate whether regional pricing strategies need adjustment or if customer should be consolidated to primary facility where possible. Premier accounts with known MoQs should always be served by their primary facility to keep up with SLAs and to minimize holding costs.
  
</Alert>



# Product Type Profitability

```sql product_ranking
SELECT * FROM product_profitability 
ORDER BY margin_pct DESC
```




<DataTable data={product_ranking}>
    <Column id=Product_Type title="Product Type"/>
    <Column id=volume title="Volume (tons)" fmt='#,##0'/>
    <Column id=revenue title="Revenue" fmt='$#,##0'/>
    <Column id=profit title="Profit" fmt='$#,##0' contentType=colorscale scaleColor=green/>
    <Column id=margin_pct title="Margin %" fmt='#0.0"%"' contentType=colorscale scaleColor=green/>
    <Column id=profit_per_ton title="$/Ton" fmt='$#,##0'/>
</DataTable>

## Product Portfolio Matrix

```sql portfolio
SELECT * FROM portfolio_matrix 
ORDER BY total_profit DESC
```

<ScatterPlot
    data={portfolio}
    x=total_volume
    y=margin_pct
    series=Product_Type
    size=total_profit
    title="Product Portfolio: Volume vs Margin "
    xFmt='#,##0'
    yFmt='#0.0"%"'
/>

<Alert status="warning">

**Recommendation:**
High-margin products deserve premium positioning and marketing investment. Focus on high-volume, higher-margin items such as Sustainable, Miniature, and Customized widgets for growth.

</Alert>


# Product Strategy: 


<Alert>

- High volume + high margin = Protect and grow

- High volume + low margin = Improve pricing or efficiency

- Low volume + high margin = Expand carefully

- Low volume + low margin = Consider discontinuation on lowest-margin items or seeking new customers for increased demand.

</Alert>

<DataTable data={portfolio}>
    <Column id=Product_Type title="Product"/>
    <Column id=volume_category title="Volume"/>
    <Column id=margin_category title="Margin"/>
    <Column id=total_volume title="Tons" fmt='#,##0'/>
    <Column id=margin_pct title="Margin %" fmt='#0.0"%"' contentType=colorscale scaleColor=green/>
    <Column id=total_profit title="Profit" fmt='$#,##0'/>
</DataTable>

## Unprofitable Segments

```sql unprofitable_segments
SELECT * FROM unprofitable_analysis
ORDER BY total_profit ASC
```

Every dollar lost here is a direct opportunity for margin improvement. These customer and product segments require immediate action - whether price increases, cost reduction, or strategic exits. Low-hanging fruit for profitability gains 

<DataTable data={unprofitable_segments}>
    <Column id=segment_type title="Type"/>
    <Column id=segment_name title="Name"/>
    <Column id=total_profit title="Loss" fmt='$#,##0' contentType=colorscale scaleColor=red/>
    <Column id=revenue title="Revenue" fmt='$#,##0'/>
    <Column id=transaction_count title="Orders" fmt='#,##0'/>
</DataTable>

```sql unprofitable_impact
SELECT 
    SUM(total_profit) as total_losses
FROM unprofitable_analysis
```


 <Alert status="warning">

  ## Action Plan: 
  - Prioritize by size of loss - address the biggest offenders first with pricing corrections or service level adjustments. 
  - Set 90-120 day deadlines for all segments to reach breakeven or exit.

</Alert>
